{"version":3,"names":["registerInternalPlugin","Presence","payloadTransformer","predicates","name","direction","test","ctx","response","resolve","extract","transforms","fn","body","status","eventType","config"],"sources":["index.js"],"sourcesContent":["/*!\n * Copyright (c) 2015-2020 Cisco Systems, Inc. See LICENSE file.\n */\n\nimport '@webex/internal-plugin-device';\n\nimport {registerInternalPlugin} from '@webex/webex-core';\nimport {has} from 'lodash';\n\nimport Presence from './presence';\nimport config from './config';\n\nregisterInternalPlugin('presence', Presence, {\n  payloadTransformer: {\n    predicates: [\n      {\n        name: 'normalizeSingleStatusResponse',\n        direction: 'inbound',\n        test(ctx, response) {\n          // POST to /apheleia/api/v1/events\n          return Promise.resolve(has(response, 'body.eventType') && has(response, 'body.subject'));\n        },\n        extract(response) {\n          return Promise.resolve(response);\n        }\n      }\n    ],\n    transforms: [\n      {\n        name: 'normalizeSingleStatusResponse',\n        direction: 'inbound',\n        fn(ctx, response) {\n          response.body.status = response.body.eventType;\n        }\n      }\n    ]\n  },\n  config\n});\n\nexport {default} from './presence';\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;AAIA;;AAEA;;AAGA;;AACA;;AAVA;AACA;AACA;AAUA,IAAAA,iCAAA,EAAuB,UAAvB,EAAmCC,iBAAnC,EAA6C;EAC3CC,kBAAkB,EAAE;IAClBC,UAAU,EAAE,CACV;MACEC,IAAI,EAAE,+BADR;MAEEC,SAAS,EAAE,SAFb;MAGEC,IAHF,gBAGOC,GAHP,EAGYC,QAHZ,EAGsB;QAClB;QACA,OAAO,iBAAQC,OAAR,CAAgB,mBAAID,QAAJ,EAAc,gBAAd,KAAmC,mBAAIA,QAAJ,EAAc,cAAd,CAAnD,CAAP;MACD,CANH;MAOEE,OAPF,mBAOUF,QAPV,EAOoB;QAChB,OAAO,iBAAQC,OAAR,CAAgBD,QAAhB,CAAP;MACD;IATH,CADU,CADM;IAclBG,UAAU,EAAE,CACV;MACEP,IAAI,EAAE,+BADR;MAEEC,SAAS,EAAE,SAFb;MAGEO,EAHF,cAGKL,GAHL,EAGUC,QAHV,EAGoB;QAChBA,QAAQ,CAACK,IAAT,CAAcC,MAAd,GAAuBN,QAAQ,CAACK,IAAT,CAAcE,SAArC;MACD;IALH,CADU;EAdM,CADuB;EAyB3CC,MAAM,EAANA;AAzB2C,CAA7C"}