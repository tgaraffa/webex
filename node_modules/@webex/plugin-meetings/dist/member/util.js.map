{"version":3,"names":["MemberUtil","isUser","participant","type","_USER_","isModerator","moderator","isGuest","guest","isDevice","_RESOURCE_ROOM_","isModeratorAssignmentProhibited","moderatorAssignmentNotAllowed","isSame","id","person","isAssociatedSame","associatedUsers","some","user","isNotAdmitted","status","devices","intent","_WAIT_","_IN_LOBBY_","_IN_MEETING_","isAudioMuted","ParameterError","mutedStatus","isMuted","AUDIO_STATUS","controls","audio","muted","isVideoMuted","VIDEO_STATUS","isHandRaised","hand","raised","accessor","_RECEIVE_ONLY_","_SEND_RECEIVE_","getRecordingMember","record","recording","meta","modifiedBy","isRecording","localRecord","isRemovable","isSelf","isInMeeting","_CALL_","isMutable","extractStatus","length","_NOT_IN_MEETING_","state","_JOINED_","_IDLE_","foundDevice","find","device","_OBSERVE_","_LEFT_","extractId","extractName","name"],"sources":["util.js"],"sourcesContent":["import {\n  _USER_,\n  _RESOURCE_ROOM_,\n  _OBSERVE_,\n  _WAIT_,\n  _LEFT_,\n  _JOINED_,\n  _IDLE_,\n  _IN_LOBBY_,\n  _NOT_IN_MEETING_,\n  _IN_MEETING_,\n  AUDIO_STATUS,\n  VIDEO_STATUS,\n  _SEND_RECEIVE_,\n  _RECEIVE_ONLY_,\n  _CALL_\n} from '../constants';\nimport ParameterError from '../common/errors/parameter';\n\nconst MemberUtil = {};\n\n/**\n * @param {Object} participant the locus participant\n * @returns {Boolean}\n */\nMemberUtil.isUser = (participant) => participant && participant.type === _USER_;\n\nMemberUtil.isModerator = (participant) => participant && participant.moderator;\n\n/**\n * @param {Object} participant the locus participant\n * @returns {Boolean}\n */\nMemberUtil.isGuest = (participant) => participant && participant.guest;\n\n/**\n * @param {Object} participant the locus participant\n * @returns {Boolean}\n */\nMemberUtil.isDevice = (participant) => participant && participant.type === _RESOURCE_ROOM_;\n\nMemberUtil.isModeratorAssignmentProhibited = (participant) => participant && participant.moderatorAssignmentNotAllowed;\n\n/**\n * checks to see if the participant id is the same as the passed id\n * there are multiple ids that can be used\n * @param {Object} participant the locus participant\n * @param {String} id\n * @returns {Boolean}\n */\nMemberUtil.isSame = (participant, id) => participant &&\n  (participant.id === id || participant.person && participant.person.id === id);\n\n/**\n * checks to see if the participant id is the same as the passed id for associated devices\n * there are multiple ids that can be used\n * @param {Object} participant the locus participant\n * @param {String} id\n * @returns {Boolean}\n */\nMemberUtil.isAssociatedSame = (participant, id) => participant &&\nparticipant.associatedUsers &&\nparticipant.associatedUsers.some((user) => (user.id === id || user.person && user.person.id === id));\n\n/**\n * @param {Object} participant the locus participant\n * @param {Boolean} isGuest\n * @param {String} status\n * @returns {Boolean}\n */\nMemberUtil.isNotAdmitted = (participant, isGuest, status) => participant &&\n  participant.guest && ((participant.devices && participant.devices[0] &&\n  participant.devices[0].intent && participant.devices[0].intent.type === _WAIT_ &&\n  isGuest && status === _IN_LOBBY_) || !status === _IN_MEETING_);\n\n/**\n * @param {Object} participant the locus participant\n * @returns {Boolean}\n */\nMemberUtil.isAudioMuted = (participant) => {\n  if (!participant) {\n    throw new ParameterError('Audio could not be processed, participant is undefined.');\n  }\n  const mutedStatus = MemberUtil.isMuted(participant.status, AUDIO_STATUS);\n\n  if (participant.controls && participant.controls.audio) {\n    if (participant.controls.audio.muted) {\n      return true;\n    }\n    if (mutedStatus) {\n      return true;\n    }\n  }\n\n  return false;\n};\n\n/**\n * @param {Object} participant the locus participant\n * @returns {Boolean}\n */\nMemberUtil.isVideoMuted = (participant) => {\n  if (!participant) {\n    throw new ParameterError('Video could not be processed, participant is undefined.');\n  }\n\n  return MemberUtil.isMuted(participant.status, VIDEO_STATUS);\n};\n\n/**\n * @param {Object} participant the locus participant\n * @returns {Boolean}\n */\nMemberUtil.isHandRaised = (participant) => {\n  if (!participant) {\n    throw new ParameterError('Raise hand could not be processed, participant is undefined.');\n  }\n\n  return participant.controls?.hand?.raised || false;\n};\n\n/**\n * utility method for audio/video muted status\n * @param {String} status\n * @param {String} accessor\n * @returns {Boolean}\n */\nMemberUtil.isMuted = (status, accessor) => {\n  if (status) {\n    if (status[accessor] === _RECEIVE_ONLY_) {\n      return true;\n    }\n    if (status[accessor] === _SEND_RECEIVE_) {\n      return false;\n    }\n  }\n\n  return null;\n};\n\n/**\n * utility method for getting the recording member for later comparison\n * @param {Object} controls\n * @returns {String|null}\n */\nMemberUtil.getRecordingMember = (controls) => {\n  if (!controls) {\n    return null;\n  }\n  if (controls.record && controls.record.recording && controls.record.meta) {\n    return controls.record.meta.modifiedBy;\n  }\n\n  return null;\n};\n\n/**\n * @param {Object} participant the locus participant\n * @returns {Boolean}\n */\nMemberUtil.isRecording = (participant) => {\n  if (!participant) {\n    throw new ParameterError('Recording could not be processed, participant is undefined.');\n  }\n  if (participant.controls && participant.controls.localRecord) {\n    return participant.controls.localRecord.recording;\n  }\n\n  return false;\n};\n\nMemberUtil.isRemovable = (isSelf, isGuest, isInMeeting, type) => {\n  if (isGuest || isSelf) {\n    return false;\n  }\n  if (type === _CALL_) {\n    return false;\n  }\n  if (isInMeeting) {\n    return true;\n  }\n\n  return false;\n};\n\nMemberUtil.isMutable = (isSelf, isDevice, isInMeeting, isMuted, type) => {\n  if (!isInMeeting) {\n    return false;\n  }\n  if (isMuted) {\n    return false;\n  }\n  if (type === _CALL_) {\n    return false;\n  }\n  if (isSelf || isDevice) {\n    return true;\n  }\n\n  return false;\n};\n\n/**\n * @param {Object} participant the locus participant\n * @returns {String}\n */\nMemberUtil.extractStatus = (participant) => {\n  if (!(participant && participant.devices && participant.devices.length)) {\n    return _NOT_IN_MEETING_;\n  }\n  if (participant.state === _JOINED_) {\n    return _IN_MEETING_;\n  }\n  if (participant.state === _IDLE_) {\n    if (participant.devices && participant.devices.length > 0) {\n      const foundDevice = participant.devices.find((device) => device.intent && (device.intent.type === _WAIT_ || device.intent.type === _OBSERVE_));\n\n      return foundDevice ? _IN_LOBBY_ : _NOT_IN_MEETING_;\n    }\n\n    return _NOT_IN_MEETING_;\n  }\n  if (participant.state === _LEFT_) {\n    return _NOT_IN_MEETING_;\n  }\n\n  return _NOT_IN_MEETING_;\n};\n\n/**\n * @param {Object} participant the locus participant\n * @returns {String}\n */\nMemberUtil.extractId = (participant) => {\n  if (participant) {\n    return participant.id;\n  }\n\n  return null;\n};\n\n/**\n * @param {Object} participant the locus participant\n * @returns {String}\n */\nMemberUtil.extractName = (participant) => {\n  if (participant && participant.person) {\n    return participant.person.name;\n  }\n\n  return null;\n};\n\nexport default MemberUtil;\n"],"mappings":"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"}