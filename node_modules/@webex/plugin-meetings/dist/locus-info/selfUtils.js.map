{"version":3,"names":["SelfUtils","PSTN_DEVICE_TYPE","parse","self","deviceId","joinedWith","devices","find","device","url","pstnDevices","filter","deviceType","remoteMuted","getRemoteMuted","unmuteAllowed","getUnmuteAllowed","localAudioUnmuteRequested","getLocalAudioUnmuteRequested","localAudioUnmuteRequired","getLocalAudioUnmuteRequired","lastModified","getLastModified","modifiedBy","getModifiedBy","guest","moderator","mediaStatus","getStatus","status","state","currentMediaStatus","getMediaStatus","mediaSessions","creator","isCreator","selfId","id","selfIdentity","getSelfIdentity","selfUrl","removed","roles","getRoles","isUserUnadmitted","_IDLE_","intent","type","_WAIT_","layout","getLayout","controls","layouts","undefined","role","reduce","hasRole","push","getSelves","oldSelf","newSelf","previous","current","updates","isUserAdmitted","isMutedByOthersChanged","mutedByOthersChanged","localAudioUnmuteRequestedByServer","localAudioUnmuteRequiredByServer","moderatorChanged","isMediaInactiveOrReleased","wasMediaInactiveOrReleased","isUserObserving","isDeviceObserving","layoutChanged","isMediaInactive","audioStateChange","audio","videoStateChange","video","shareStateChange","share","isJoined","_JOINED_","previousMediaStatus","MEDIA_STATE","inactive","direction","meta","person","muted","requestedToUnmute","disallowUnmute","audioStatus","videoStatus","slides","videoSlidesStatus","changedSelf","_LEFT_","reason","MEETING_END_REASON","INACTIVE","MEDIA_RELEASED","isLocusUserUnadmitted","check","isLocusUserAdmitted","ParameterError","_MOVE_MEDIA_","_OBSERVE_","getSipUrl","partner","sipUri","_CALL_","sipUrl","media","mediaType","AUDIO","mediaContent","MediaContent","main","VIDEO"],"sources":["selfUtils.js"],"sourcesContent":["\nimport {\n  _IDLE_,\n  _JOINED_,\n  _CALL_,\n  _WAIT_,\n  _MOVE_MEDIA_,\n  _OBSERVE_,\n  _LEFT_,\n  MEETING_END_REASON,\n  MEDIA_STATE,\n  AUDIO,\n  VIDEO,\n  MediaContent\n} from '../constants';\nimport ParameterError from '../common/errors/parameter';\n\nconst SelfUtils = {};\nconst PSTN_DEVICE_TYPE = 'PROVISIONAL';\n\n/**\n * parses the relevant values for self: muted, guest, moderator, mediaStatus, state, joinedWith, pstnDevices, creator, id\n * @param {Object} self\n * @param {String} deviceId\n * @returns {undefined}\n */\nSelfUtils.parse = (self, deviceId) => {\n  if (self) {\n    const joinedWith = self.devices.find((device) => deviceId === device.url);\n    const pstnDevices = self.devices.filter((device) => PSTN_DEVICE_TYPE === device.deviceType);\n\n    return {\n      remoteMuted: SelfUtils.getRemoteMuted(self),\n      unmuteAllowed: SelfUtils.getUnmuteAllowed(self),\n      localAudioUnmuteRequested: SelfUtils.getLocalAudioUnmuteRequested(self),\n      localAudioUnmuteRequired: SelfUtils.getLocalAudioUnmuteRequired(self),\n      lastModified: SelfUtils.getLastModified(self),\n      modifiedBy: SelfUtils.getModifiedBy(self),\n      guest: self.guest,\n      moderator: self.moderator,\n      // cumulative media stats\n      mediaStatus: SelfUtils.getStatus(self.status),\n      // TODO: what should be the status if user has refreshed the page,\n      // check the joinedWith parameter and communicate to the user\n      state: self.state,\n      // TODO: give a proper name . With same device as login or different login`\n      // Some times we might have joined with both mobile and web\n      joinedWith,\n      pstnDevices,\n      // current media stats is for the current device who has joined\n      currentMediaStatus: SelfUtils.getMediaStatus(\n        joinedWith?.mediaSessions\n      ),\n      creator: self.isCreator, // check if its used,\n      selfId: self.id,\n      selfIdentity: SelfUtils.getSelfIdentity(self),\n      selfUrl: self.url,\n      removed: self.removed,\n      roles: SelfUtils.getRoles(self),\n      isUserUnadmitted: self.state === _IDLE_ && joinedWith?.intent?.type === _WAIT_,\n      layout: SelfUtils.getLayout(self)\n    };\n  }\n\n  return null;\n};\n\nSelfUtils.getLayout = (self) => (Array.isArray(self?.controls?.layouts) ? self.controls.layouts[0].type : undefined);\n\nSelfUtils.getRoles = (self) => (self?.controls?.role?.roles || []).reduce((roles, role) => {\n  if (role.hasRole) {\n    roles.push(role.type);\n  }\n\n  return roles;\n}, []);\n\nSelfUtils.getSelves = (oldSelf, newSelf, deviceId) => {\n  const previous = oldSelf && SelfUtils.parse(oldSelf, deviceId);\n  const current = newSelf && SelfUtils.parse(newSelf, deviceId);\n  const updates = {};\n\n  updates.isUserUnadmitted = SelfUtils.isUserUnadmitted(current);\n  updates.isUserAdmitted = SelfUtils.isUserAdmitted(previous, current);\n  updates.isMutedByOthersChanged = SelfUtils.mutedByOthersChanged(previous, current);\n  updates.localAudioUnmuteRequestedByServer = SelfUtils.localAudioUnmuteRequestedByServer(previous, current);\n  updates.localAudioUnmuteRequiredByServer = SelfUtils.localAudioUnmuteRequiredByServer(previous, current);\n  updates.moderatorChanged = SelfUtils.moderatorChanged(previous, current);\n  updates.isMediaInactiveOrReleased = SelfUtils.wasMediaInactiveOrReleased(previous, current);\n  updates.isUserObserving = SelfUtils.isDeviceObserving(previous, current);\n  updates.layoutChanged = SelfUtils.layoutChanged(previous, current);\n\n  updates.isMediaInactive = SelfUtils.isMediaInactive(previous, current);\n  updates.audioStateChange = previous?.currentMediaStatus.audio !== current.currentMediaStatus.audio;\n  updates.videoStateChange = previous?.currentMediaStatus.video !== current.currentMediaStatus.video;\n  updates.shareStateChange = previous?.currentMediaStatus.share !== current.currentMediaStatus.share;\n\n  return {\n    previous,\n    current,\n    updates\n  };\n};\n\n/**\n * Checks if user has joined the meeting\n * @param {Object} self\n * @returns {boolean} isJoined\n*/\nSelfUtils.isJoined = (self) => self?.state === _JOINED_;\n\n/**\n * Validate if the Meeting Layout Controls Layout has changed.\n *\n * @param {Self} previous - Previous self state\n * @param {Self} current - Current self state [per event]\n * @returns {boolean} - If the MEeting Layout Controls Layout has changed.\n */\nSelfUtils.layoutChanged = (previous, current) => current?.layout && previous?.layout !== current?.layout;\n\n\nSelfUtils.isMediaInactive = (previous, current) => {\n  if (\n    previous &&\n    previous.joinedWith &&\n    previous.joinedWith.mediaSessions &&\n    current &&\n    current.joinedWith &&\n    current.joinedWith.mediaSessions\n  ) {\n    const previousMediaStatus = SelfUtils.getMediaStatus(\n      previous.joinedWith.mediaSessions\n    );\n    const currentMediaStatus = SelfUtils.getMediaStatus(\n      current.joinedWith.mediaSessions\n    );\n\n    if (\n      previousMediaStatus.audio && currentMediaStatus.audio &&\n      previousMediaStatus.audio.state !== MEDIA_STATE.inactive &&\n      currentMediaStatus.audio.state === MEDIA_STATE.inactive &&\n      currentMediaStatus.audio.direction !== MEDIA_STATE.inactive\n    ) {\n      return true;\n    }\n\n    if (\n      previousMediaStatus.video && currentMediaStatus.video &&\n      previousMediaStatus.video.state !== MEDIA_STATE.inactive &&\n      currentMediaStatus.video.state === MEDIA_STATE.inactive &&\n      currentMediaStatus.video.direction !== MEDIA_STATE.inactive\n    ) {\n      return true;\n    }\n\n    if (\n      previousMediaStatus.share && currentMediaStatus.share &&\n      previousMediaStatus.share.state !== MEDIA_STATE.inactive &&\n      currentMediaStatus.share.state === MEDIA_STATE.inactive &&\n      currentMediaStatus.share.direction !== MEDIA_STATE.inactive\n    ) {\n      return true;\n    }\n\n    return false;\n  }\n\n  return false;\n};\n\nSelfUtils.getLastModified = (self) => {\n  if (!self || !self.controls || !self.controls.audio || !self.controls.audio.meta || !self.controls.audio.meta.lastModified) {\n    return null;\n  }\n\n  return self.controls.audio.meta.lastModified;\n};\n\nSelfUtils.getModifiedBy = (self) => {\n  if (!self || !self.controls || !self.controls.audio || !self.controls.audio.meta || !self.controls.audio.meta.modifiedBy) {\n    return null;\n  }\n\n  return self.controls.audio.meta.modifiedBy;\n};\n\n/**\n * get the id from the self object\n * @param {Object} self\n * @returns {String}\n */\nSelfUtils.getSelfIdentity = (self) => {\n  if (!self && !self.person) {\n    return null;\n  }\n\n  return self.person.id;\n};\n\n/**\n * get the \"remote mute\" property from the self object\n * @param {Object} self\n * @returns {Boolean}\n */\nSelfUtils.getRemoteMuted = (self) => {\n  if (!self || !self.controls || !self.controls.audio) {\n    return null;\n  }\n\n  return self.controls.audio.muted;\n};\n\nSelfUtils.getLocalAudioUnmuteRequested = (self) => !!self?.controls?.audio?.requestedToUnmute;\n\nSelfUtils.getUnmuteAllowed = (self) => {\n  if (!self || !self.controls || !self.controls.audio) {\n    return null;\n  }\n\n  return !self.controls.audio.disallowUnmute;\n};\n\n\nSelfUtils.getLocalAudioUnmuteRequired = (self) => !!self?.controls?.audio?.localAudioUnmuteRequired;\n\nSelfUtils.getStatus = (status) => ({\n  audio: status.audioStatus,\n  video: status.videoStatus,\n  slides: status.videoSlidesStatus\n});\n\n\n/**\n * @param {Object} oldSelf\n * @param {Object} changedSelf\n * @returns {Boolean}\n */\nSelfUtils.wasMediaInactiveOrReleased = (oldSelf = {}, changedSelf) => oldSelf.joinedWith && oldSelf.joinedWith.state === _JOINED_ && changedSelf.joinedWith.state === _LEFT_ &&\n (changedSelf.joinedWith.reason === MEETING_END_REASON.INACTIVE || changedSelf.joinedWith.reason === MEETING_END_REASON.MEDIA_RELEASED);\n\n\n/**\n * @param {Object} check\n * @returns {Boolean}\n */\nSelfUtils.isLocusUserUnadmitted = (check) => check && check.joinedWith?.intent?.type === _WAIT_ && check.state === _IDLE_;\n\n/**\n * @param {Object} check\n * @returns {Boolean}\n */\nSelfUtils.isLocusUserAdmitted = (check) => check && check.joinedWith?.intent?.type !== _WAIT_ && check.state === _JOINED_;\n\n/**\n * @param {Object} self\n * @returns {Boolean}\n * @throws {Error} when self is undefined\n */\nSelfUtils.isUserUnadmitted = (self) => {\n  if (!self) {\n    throw new ParameterError('self must be defined to determine if self is unadmitted as guest.');\n  }\n\n  return SelfUtils.isLocusUserUnadmitted(self);\n};\n\nSelfUtils.moderatorChanged = (oldSelf, changedSelf) => {\n  if (!oldSelf) {\n    return true;\n  }\n  if (!changedSelf) {\n    throw new ParameterError('New self must be defined to determine if self transitioned moderator status.');\n  }\n\n  return oldSelf.moderator !== changedSelf.moderator;\n};\n\n\n/**\n * @param {Object} oldSelf\n * @param {Object} changedSelf\n * @returns {Boolean}\n * @throws {Error} if changed self was undefined\n */\nSelfUtils.isDeviceObserving = (oldSelf, changedSelf) => oldSelf && oldSelf.joinedWith?.intent?.type === _MOVE_MEDIA_ && changedSelf && changedSelf.joinedWith?.intent?.type === _OBSERVE_;\n\n/**\n * @param {Object} oldSelf\n * @param {Object} changedSelf\n * @returns {Boolean}\n * @throws {Error} if changed self was undefined\n */\nSelfUtils.isUserAdmitted = (oldSelf, changedSelf) => {\n  if (!oldSelf) {\n    // if there was no previous locus, it couldn't have been admitted yet\n    return false;\n  }\n  if (!changedSelf) {\n    throw new ParameterError('New self must be defined to determine if self transitioned to admitted as guest.');\n  }\n\n  return SelfUtils.isLocusUserUnadmitted(oldSelf) && SelfUtils.isLocusUserAdmitted(changedSelf);\n};\n\nSelfUtils.mutedByOthersChanged = (oldSelf, changedSelf) => {\n  if (!changedSelf) {\n    throw new ParameterError('New self must be defined to determine if self was muted by others.');\n  }\n\n  if (!oldSelf || (oldSelf.remoteMuted === null)) {\n    if (changedSelf.remoteMuted) {\n      return true; // this happens when mute on-entry is enabled\n    }\n\n    // we don't want to be sending the 'meeting:self:unmutedByOthers' notification on meeting join\n    return false;\n  }\n\n  return (changedSelf.remoteMuted !== null) &&\n    ((oldSelf.remoteMuted !== changedSelf.remoteMuted) || (changedSelf.remoteMuted && (oldSelf.unmuteAllowed !== changedSelf.unmuteAllowed)));\n};\n\nSelfUtils.localAudioUnmuteRequestedByServer = (oldSelf = {}, changedSelf) => {\n  if (!changedSelf) {\n    throw new ParameterError('New self must be defined to determine if self received request to unmute.');\n  }\n\n  return changedSelf.localAudioUnmuteRequested && !oldSelf.localAudioUnmuteRequested;\n};\n\n\nSelfUtils.localAudioUnmuteRequiredByServer = (oldSelf = {}, changedSelf) => {\n  if (!changedSelf) {\n    throw new ParameterError('New self must be defined to determine if localAudioUnmuteRequired changed.');\n  }\n\n  return !changedSelf.remoteMuted && changedSelf.localAudioUnmuteRequired && (oldSelf.localAudioUnmuteRequired !== changedSelf.localAudioUnmuteRequired);\n};\n\n/**\n * extract the sipUrl from the partner\n * @param {Object} partner\n * @param {Object} info\n * @returns {Object}\n */\n\nSelfUtils.getSipUrl = (partner, type, sipUri) => {\n  // For webex meeting the sipUrl gets updated in info parser\n  if (partner && type === _CALL_) {\n    return {sipUri: partner.person.sipUrl || partner.person.id};\n  }\n\n  return {sipUri};\n};\n\nSelfUtils.getMediaStatus = (mediaSessions = []) => {\n  const mediaStatus = {\n    audio: {},\n    video: {},\n    share: {}\n  };\n\n  mediaStatus.audio = mediaSessions.find((media) => media.mediaType === AUDIO && media.mediaContent === MediaContent.main);\n  mediaStatus.video = mediaSessions.find((media) => media.mediaType === VIDEO && media.mediaContent === MediaContent.main);\n  mediaStatus.share = mediaSessions.find((media) => media.mediaType === VIDEO && media.mediaContent === MediaContent.slides);\n\n  return mediaStatus;\n};\n\n\nexport default SelfUtils;\n"],"mappings":"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"}