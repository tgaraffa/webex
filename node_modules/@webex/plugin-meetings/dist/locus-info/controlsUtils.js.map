{"version":3,"names":["ControlsUtils","parse","controls","parsedControls","record","modifiedBy","getId","paused","recording","lastModified","meta","meetingContainer","meetingContainerUrl","transcribe","transcribing","caption","getControls","oldControls","newControls","previous","current","updates","hasRecordingPausedChanged","hasRecordingChanged","hasMeetingContainerChanged","hasTranscribeChanged"],"sources":["controlsUtils.js"],"sourcesContent":["import {isEqual} from 'lodash';\n\nconst ControlsUtils = {};\n\n/**\n * Controls\n * @typedef {Object} LocusControls\n * @property {Object} record\n * @property {Boolean} record.recording\n * @property {Object} record.meta\n * @property {String} record.meta.modifiedBy\n */\n\n/**\n * parse the relevant host values that we care about: id\n * @param {LocusControls} controls\n * @returns {Object} parsedObject - parsed host or null if host was undefined\n * @returns {String} parsedObject.recordingId\n */\nControlsUtils.parse = (controls) => {\n  const parsedControls = {...controls};\n\n  if (controls && controls.record) {\n    parsedControls.record = {\n      modifiedBy: ControlsUtils.getId(controls),\n      paused: controls.record.paused ? controls.record.paused : false,\n      recording: controls.record.recording,\n      lastModified: controls.record.meta.lastModified\n    };\n  }\n\n  if (controls && controls.meetingContainer) {\n    parsedControls.meetingContainer = {\n      meetingContainerUrl: controls.meetingContainer.meetingContainerUrl\n    };\n  }\n\n  if (controls && controls.transcribe) {\n    parsedControls.transcribe = {\n      transcribing: controls.transcribe.transcribing,\n      caption: controls.transcribe.caption\n    };\n  }\n\n  return parsedControls;\n};\n\n/**\n * parses and returns previous state vs current state and triggers the changes.\n * @param {LocusControl} oldControls previous state\n * @param {LocusControl} newControls current state\n * @returns {Object} combination of state plus the changes\n */\nControlsUtils.getControls = (oldControls, newControls) => {\n  const previous = ControlsUtils.parse(oldControls);\n  const current = ControlsUtils.parse(newControls);\n\n  return {\n    previous,\n    current,\n    updates: {\n      hasRecordingPausedChanged: current?.record &&\n      !isEqual(previous?.record?.paused, current.record.paused) &&\n      (previous?.record?.recording || current?.record?.recording), // see comments directly below\n\n      hasRecordingChanged: current?.record &&\n      !isEqual(previous?.record?.recording, current?.record?.recording) && // upon first join, previous?.record?.recording = undefined; thus, never going to be equal and will always return true\n      (previous?.record?.recording || current?.record?.recording), // therefore, condition added to prevent false firings of #meeting:recording:stopped upon first joining a meeting\n\n      hasMeetingContainerChanged: current?.meetingContainer &&\n        !isEqual(previous?.meetingContainer?.meetingContainerUrl,\n          current?.meetingContainer?.meetingContainerUrl),\n\n      hasTranscribeChanged: current?.transcribe &&\n          !isEqual(previous?.transcribe?.transcribing, current?.transcribe?.transcribing) && // upon first join, previous?.record?.recording = undefined; thus, never going to be equal and will always return true\n          (previous?.transcribe?.transcribing || current?.transcribe?.transcribing), // therefore, condition added to prevent false firings of #meeting:recording:stopped upon first joining a meeting\n    }\n  };\n};\n\n/**\n * Extract the id from the record controls object\n * @param {LocusControls} controls\n * @returns {String|null}\n */\nControlsUtils.getId = (controls) => {\n  if (controls.record.meta) {\n    return controls.record.meta.modifiedBy;\n  }\n\n  return null;\n};\n\nexport default ControlsUtils;\n"],"mappings":"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"}