{"version":3,"names":["PersonUUIDRequestBatcher","Batcher","extend","namespace","handleHttpSuccess","res","promises","body","items","map","personResponse","handleItemSuccess","id","notFoundIds","concat","handleItemFailure","all","getDeferredForResponse","then","defer","reject","email","response","resolve","fingerprintRequest","uuidOrHydraId","hydraId","webex","people","inferPersonIdFromUuid","fingerprintResponse","prepareRequest","ids","join","submitHttpRequest","request","service","resource","config","showAllTypes"],"sources":["people-batcher.js"],"sourcesContent":["/*!\n * Copyright (c) 2015-2020 Cisco Systems, Inc. See LICENSE file.\n */\n\nimport {Batcher} from '@webex/webex-core';\n\n/**\n * @class\n * @ignore\n */\nconst PersonUUIDRequestBatcher = Batcher.extend({\n  namespace: 'People',\n\n  /**\n   * @instance\n   * @memberof PersonUUIDRequestBatcher\n   * @param {HttpResponseObject} res\n   * @returns {Promise}\n   */\n  handleHttpSuccess(res) {\n    const promises = res.body.items.map((personResponse) =>\n      this.handleItemSuccess(personResponse.id, personResponse));\n\n    if (res.body.notFoundIds) {\n      promises.concat(res.body.notFoundIds.map((id) =>\n        this.handleItemFailure(id)));\n    }\n\n    return Promise.all(promises);\n  },\n\n  handleItemFailure(id) {\n    return this.getDeferredForResponse(id)\n      .then((defer) => {\n        defer.reject(id);\n      });\n  },\n\n  /**\n   * @instance\n   * @memberof PersonUUIDRequestBatcher\n   * @param {string} email\n   * @param {Object} response\n   * @returns {Promise}\n   */\n  handleItemSuccess(email, response) {\n    return this.getDeferredForResponse(email)\n      .then((defer) => {\n        defer.resolve(response);\n      });\n  },\n\n  /**\n   * @instance\n   * @memberof PersonUUIDRequestBatcher\n   * @param {string} uuidOrHydraId\n   * @returns {Promise<string>}\n   */\n  fingerprintRequest(uuidOrHydraId) {\n    const hydraId = this.webex.people.inferPersonIdFromUuid(uuidOrHydraId);\n\n    return Promise.resolve(hydraId);\n  },\n\n  /**\n   * @instance\n   * @memberof PersonUUIDRequestBatcher\n   * @param {string} hydraId\n   * @returns {Promise<string>}\n   */\n  fingerprintResponse(hydraId) {\n    return Promise.resolve(hydraId);\n  },\n\n  prepareRequest(ids) {\n    return Promise.resolve(ids.join());\n  },\n\n  /**\n   * @instance\n   * @memberof PersonUUIDRequestBatcher\n   * @param {Object} ids\n   * @returns {Promise<HttpResponseObject>}\n   */\n  submitHttpRequest(ids) {\n    return this.webex.request({\n      service: 'hydra',\n      resource: `people/?id=${ids}&showAllTypes=${this.config.showAllTypes}`\n    });\n  }\n});\n\nexport default PersonUUIDRequestBatcher;\n"],"mappings":";;;;;;;;;;;;;;AAIA;;AAJA;AACA;AACA;;AAIA;AACA;AACA;AACA;AACA,IAAMA,wBAAwB,GAAGC,kBAAA,CAAQC,MAAR,CAAe;EAC9CC,SAAS,EAAE,QADmC;;EAG9C;AACF;AACA;AACA;AACA;AACA;EACEC,iBAT8C,6BAS5BC,GAT4B,EASvB;IAAA;;IACrB,IAAMC,QAAQ,GAAGD,GAAG,CAACE,IAAJ,CAASC,KAAT,CAAeC,GAAf,CAAmB,UAACC,cAAD;MAAA,OAClC,KAAI,CAACC,iBAAL,CAAuBD,cAAc,CAACE,EAAtC,EAA0CF,cAA1C,CADkC;IAAA,CAAnB,CAAjB;;IAGA,IAAIL,GAAG,CAACE,IAAJ,CAASM,WAAb,EAA0B;MACxBP,QAAQ,CAACQ,MAAT,CAAgBT,GAAG,CAACE,IAAJ,CAASM,WAAT,CAAqBJ,GAArB,CAAyB,UAACG,EAAD;QAAA,OACvC,KAAI,CAACG,iBAAL,CAAuBH,EAAvB,CADuC;MAAA,CAAzB,CAAhB;IAED;;IAED,OAAO,iBAAQI,GAAR,CAAYV,QAAZ,CAAP;EACD,CAnB6C;EAqB9CS,iBArB8C,6BAqB5BH,EArB4B,EAqBxB;IACpB,OAAO,KAAKK,sBAAL,CAA4BL,EAA5B,EACJM,IADI,CACC,UAACC,KAAD,EAAW;MACfA,KAAK,CAACC,MAAN,CAAaR,EAAb;IACD,CAHI,CAAP;EAID,CA1B6C;;EA4B9C;AACF;AACA;AACA;AACA;AACA;AACA;EACED,iBAnC8C,6BAmC5BU,KAnC4B,EAmCrBC,QAnCqB,EAmCX;IACjC,OAAO,KAAKL,sBAAL,CAA4BI,KAA5B,EACJH,IADI,CACC,UAACC,KAAD,EAAW;MACfA,KAAK,CAACI,OAAN,CAAcD,QAAd;IACD,CAHI,CAAP;EAID,CAxC6C;;EA0C9C;AACF;AACA;AACA;AACA;AACA;EACEE,kBAhD8C,8BAgD3BC,aAhD2B,EAgDZ;IAChC,IAAMC,OAAO,GAAG,KAAKC,KAAL,CAAWC,MAAX,CAAkBC,qBAAlB,CAAwCJ,aAAxC,CAAhB;IAEA,OAAO,iBAAQF,OAAR,CAAgBG,OAAhB,CAAP;EACD,CApD6C;;EAsD9C;AACF;AACA;AACA;AACA;AACA;EACEI,mBA5D8C,+BA4D1BJ,OA5D0B,EA4DjB;IAC3B,OAAO,iBAAQH,OAAR,CAAgBG,OAAhB,CAAP;EACD,CA9D6C;EAgE9CK,cAhE8C,0BAgE/BC,GAhE+B,EAgE1B;IAClB,OAAO,iBAAQT,OAAR,CAAgBS,GAAG,CAACC,IAAJ,EAAhB,CAAP;EACD,CAlE6C;;EAoE9C;AACF;AACA;AACA;AACA;AACA;EACEC,iBA1E8C,6BA0E5BF,GA1E4B,EA0EvB;IACrB,OAAO,KAAKL,KAAL,CAAWQ,OAAX,CAAmB;MACxBC,OAAO,EAAE,OADe;MAExBC,QAAQ,uBAAgBL,GAAhB,2BAAoC,KAAKM,MAAL,CAAYC,YAAhD;IAFgB,CAAnB,CAAP;EAID;AA/E6C,CAAf,CAAjC;;eAkFevC,wB"}