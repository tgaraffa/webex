{"version":3,"names":["_bind","namespace","options","reject","Error","logger","map","data","forEach","key","set","debug","resolve","clear","del","delete","get","res","NotFoundError","put","value","bind","preload"],"sources":["memory-store-adapter.js"],"sourcesContent":["/*!\n * Copyright (c) 2015-2020 Cisco Systems, Inc. See LICENSE file.\n */\n\nimport {NotFoundError} from './errors';\n\n/**\n * Binds a namespace\n * @param {string} namespace\n * @param {Object} options\n * @param {Object} options.data\n * @private\n * @returns {Promise<Object>}\n */\nfunction _bind(namespace, options = {}) {\n  options = options || {};\n  if (!namespace) {\n    return Promise.reject(new Error('`namespace` is required'));\n  }\n\n  if (!options.logger) {\n    return Promise.reject(new Error('`options.logger` is required'));\n  }\n\n  const {logger} = options;\n\n  const map = new Map([['@', {}]]);\n\n  if (options.data) {\n    Object.keys(options.data).forEach((key) => {\n      map.set(key, options.data[key]);\n    });\n  }\n\n  logger.debug('memory-store-adapter: returning binding');\n\n  return Promise.resolve({\n    clear() {\n      logger.debug('memory-store-adapter: clearing the binding');\n\n      return Promise.resolve(map.clear());\n    },\n    del(key) {\n      logger.debug(`memory-store-adapter: deleting \\`${key}\\``);\n\n      return Promise.resolve(map.delete(key));\n    },\n    get(key) {\n      logger.debug(`memory-store-adapter: reading \\`${key}\\``);\n      const res = map.get(key);\n\n      if (typeof res === 'undefined') {\n        return Promise.reject(new NotFoundError());\n      }\n\n      return Promise.resolve(res);\n    },\n    put(key, value) {\n      logger.debug(`memory-store-adapter: writing \\`${key}\\``);\n\n      return Promise.resolve(map.set(key, value));\n    }\n  });\n}\n\nexport default {\n  bind: _bind,\n  preload(data) {\n    return {\n      bind(namespace, options = {}) {\n        if (data[namespace]) {\n          options.data = data[namespace];\n        }\n\n        return _bind(namespace, options);\n      }\n    };\n  }\n};\n"],"mappings":";;;;;;;;;;;;;;;;;;AAIA;;AAJA;AACA;AACA;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAASA,KAAT,CAAeC,SAAf,EAAwC;EAAA,IAAdC,OAAc,uEAAJ,EAAI;EACtCA,OAAO,GAAGA,OAAO,IAAI,EAArB;;EACA,IAAI,CAACD,SAAL,EAAgB;IACd,OAAO,iBAAQE,MAAR,CAAe,IAAIC,KAAJ,CAAU,yBAAV,CAAf,CAAP;EACD;;EAED,IAAI,CAACF,OAAO,CAACG,MAAb,EAAqB;IACnB,OAAO,iBAAQF,MAAR,CAAe,IAAIC,KAAJ,CAAU,8BAAV,CAAf,CAAP;EACD;;EAED,eAAiBF,OAAjB;EAAA,IAAOG,MAAP,YAAOA,MAAP;EAEA,IAAMC,GAAG,GAAG,iBAAQ,CAAC,CAAC,GAAD,EAAM,EAAN,CAAD,CAAR,CAAZ;;EAEA,IAAIJ,OAAO,CAACK,IAAZ,EAAkB;IAChB,mBAAYL,OAAO,CAACK,IAApB,EAA0BC,OAA1B,CAAkC,UAACC,GAAD,EAAS;MACzCH,GAAG,CAACI,GAAJ,CAAQD,GAAR,EAAaP,OAAO,CAACK,IAAR,CAAaE,GAAb,CAAb;IACD,CAFD;EAGD;;EAEDJ,MAAM,CAACM,KAAP,CAAa,yCAAb;EAEA,OAAO,iBAAQC,OAAR,CAAgB;IACrBC,KADqB,mBACb;MACNR,MAAM,CAACM,KAAP,CAAa,4CAAb;MAEA,OAAO,iBAAQC,OAAR,CAAgBN,GAAG,CAACO,KAAJ,EAAhB,CAAP;IACD,CALoB;IAMrBC,GANqB,eAMjBL,GANiB,EAMZ;MACPJ,MAAM,CAACM,KAAP,2CAAiDF,GAAjD;MAEA,OAAO,iBAAQG,OAAR,CAAgBN,GAAG,CAACS,MAAJ,CAAWN,GAAX,CAAhB,CAAP;IACD,CAVoB;IAWrBO,GAXqB,eAWjBP,GAXiB,EAWZ;MACPJ,MAAM,CAACM,KAAP,0CAAgDF,GAAhD;MACA,IAAMQ,GAAG,GAAGX,GAAG,CAACU,GAAJ,CAAQP,GAAR,CAAZ;;MAEA,IAAI,OAAOQ,GAAP,KAAe,WAAnB,EAAgC;QAC9B,OAAO,iBAAQd,MAAR,CAAe,IAAIe,qBAAJ,EAAf,CAAP;MACD;;MAED,OAAO,iBAAQN,OAAR,CAAgBK,GAAhB,CAAP;IACD,CApBoB;IAqBrBE,GArBqB,eAqBjBV,GArBiB,EAqBZW,KArBY,EAqBL;MACdf,MAAM,CAACM,KAAP,0CAAgDF,GAAhD;MAEA,OAAO,iBAAQG,OAAR,CAAgBN,GAAG,CAACI,GAAJ,CAAQD,GAAR,EAAaW,KAAb,CAAhB,CAAP;IACD;EAzBoB,CAAhB,CAAP;AA2BD;;eAEc;EACbC,IAAI,EAAErB,KADO;EAEbsB,OAFa,mBAELf,IAFK,EAEC;IACZ,OAAO;MACLc,IADK,gBACApB,SADA,EACyB;QAAA,IAAdC,OAAc,uEAAJ,EAAI;;QAC5B,IAAIK,IAAI,CAACN,SAAD,CAAR,EAAqB;UACnBC,OAAO,CAACK,IAAR,GAAeA,IAAI,CAACN,SAAD,CAAnB;QACD;;QAED,OAAOD,KAAK,CAACC,SAAD,EAAYC,OAAZ,CAAZ;MACD;IAPI,CAAP;EASD;AAZY,C"}